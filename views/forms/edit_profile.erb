<script id='edit-profile-tmpl' type='text/template' class='hide'>

	<div class='row-fluid'>
		<div class='span8'>
			<h3 id='profile-name' style='padding-right:0.5em;float:left;'>{{name}}</h3>
		</div>
		<div class='span4'>
			<a style='float:right' class='btn btn-medium'> Reset Password</a>
		</div>
	</div>

	<!-- XXX TRASH <a id='new-pm-button' class='btn' href="#" style='margin-top:0.6em;'><i class='icon-plus'></i> Payment History</a> -->

	<hr>

	<div id='edit-profile'>

		<div class='row'>
			<div class='span8'>
				<p>Has paid <strong>$0</strong> since <strong>{{created_at}}</strong>. &nbsp; <a class='btn btn-small new-charge-btn' href='#'>New Charge</a></p>
			</div>
		</div>

		<hr>


		<div class='row'>
			<div class='span8'>
				<div class='alert alert-error hide'></div>
				<div class='alert alert-success hide'></div>
			</div>
		</div> <!-- end div.row -->

		<div class='row-fluid'>

			<div class='info-group span4'>
				<p class='field-name'>
					<strong>Name</strong> &nbsp; &nbsp;
					<a class='label edit-field-btn' href='#'>
					<i class='icon-pencil icon-white'></i> edit</a>
					<small class='save-info hide'>Hit enter to save |
						<a href='#' class='cancel-edit'>Cancel.</a></small>
					<small class='save-status hide'><em>Saving...</em></small>
				</p>
				<p class='profile-field'>{{name}}</p>
				<div class='field-controls hide'>
					<input type='text' value='{{name}}' name='name' />
				</div>
			</div><!-- end div.info-group -->

			<div class='info-group span4'>
				<p class='field-name'>
					<strong>Email</strong> &nbsp; &nbsp;
					<a class='label edit-field-btn' href='#'>
					<i class='icon-pencil icon-white'></i> edit</a>
					<small class='save-info hide'>Hit enter to save |
						<a href='#' class='cancel-edit'>Cancel.</a></small>
					<small class='save-status hide'><em>Saving...</em></small>
				</p>
				<p class='profile-field'>{{email}}</p>
				<div class='field-controls hide'>
					<input type='text' value='{{email}}' name='email' />
				</div>
			</div><!-- end div.info-group -->

			<div class='info-group span4'>
				<p class='field-name'>
					<strong>Phone</strong> &nbsp; &nbsp;
					<a class='label edit-field-btn' href='#'>
					<i class='icon-pencil icon-white'></i> edit</a>
					<small class='save-info hide'>Hit enter to save |
						<a href='#' class='cancel-edit'>Cancel.</a></small>
					<small class='save-status hide'><em>Saving...</em></small>
				</p>
				<p class='profile-field'>{{phone}}</p>
				<div class='field-controls hide'>
					<input type='text' value='{{phone}}' name='phone' />
				</div>
			</div><!-- end div.info-group -->

		</div>
		<hr>
		<div class='row-fluid'>
			<div class='span12'>
				<p><strong>Notes</strong> &nbsp; &nbsp;
					<a id='profile-scratchpad-submit' class='btn btn-small' href='#'>
						<i class='icon-pencil'></i> Save</a>
					<span class='save-status hide'><small><em>Saving...</em></small></span>
				</p>
				<textarea style='height:3em;width:95%' placeholder='Scratchpad: any additional details for this subscriber' id='profile-scratchpad'>{{info}}</textarea>
			</div>
		</div>
	</div>

	<hr>

<div class='row-fluid'>

	<div class='span10'>
		<h4>Subscriptions
				:
				<small>
					{{_.reduce(_subscriptions, function(word,sub) { return word + sub.plan_name + ', '}, '').slice(0,-2)}}
				</small>
		</h4>
	</div>

	<div class='span2'>
		<a data-table-id='#subscriptions-table' class='btn btn-small' href='#' id='show-subs'>
			<i class='icon-list'></i> <span>Show</span>
		</a>
	</div>
</div>

<div class='row-fluid' style='margin-top: 0.5em'>
	<div class='span12'>
		<table class='table table-striped hide' id='subscriptions-table'>
			<tbody>
				[[ _.each(_subscriptions, function(s) { ]]
				<tr data-id='{{s.id}}'>
					<td style='font-size:1.1em'>{{s.plan_name}}</td>
					<td>{{s.state}}</td>
					<td>Since {{s.created_at}}</td>
					[[ if(s.payment_method) { ]]
						<td>
							<a class='btn'>New Charge</a>
						</td>
					[[ } else { ]]
						<td>
							<a id='new-pm-btn' class='btn'>Add Payment Method</a>
						</td>
					[[ } ]]
				</tr>
				[[ }) ]]
			</tbody>
		</table>
	</div><!-- end div.span12 -->
</div><!-- end div.row-fluid -->

<div class='row-fluid' style='margin-top: 0.5em'>
	<div class='span12'>
		<h4>Payment History

[[ if(!_.isEmpty(_transactions)) { ]]
	<small>
</h4>
	<table class='table' style='padding:1em;'>
		[[ _.each(_charges, function(c) { ]]
			<td>{{c.name}}</td>
			<td>{{c.amount}}</td>
			<td>{{c.state}}</td>
		[[ }) ]]
		<tr>
		</tr>
	</table>
[[ } else { ]]
	<p><em>No payments have been made yet.</em></p>
[[ } ]]

<div class='modal hide' id='new-pm-modal'>
	<div class='modal-header'>
		<button type="button" class="close" data-dismiss="modal">x</button>
		<h3>New Payment Method</h3>
	</div>

	<div class='modal-body'>
	<form id='new-pm-form' class='form-horizontal'>

		<div class='alert alert-error hide'></div>
		<div class='alert alert-success hide'></div>

		<div class='control-group'>
			<label class='control-label'>Type</label>
			<div class='controls'>
				<select class='new-payment-method-type' name='pay_type' style='width:9em;'>
					<option id='new-credit-card'>Credit Card</option>
					<option id='new-echeck'>E-check</option>
				</select>
			</div>
		</div>

		<div class='credit-card-selected'>
			<div class='control-group'>
				<label class='control-label'>Card Number</label>
				<div class='controls'>
					<input id="" type="text" name="card_number" value />
				</div>
			</div>

			<div class='control-group'>
				<label class='control-label'>Expiration</label>
				<div class='controls'>
					<select name='expiration_month' style='width:6em;'>
						<option>Month</option>
						[[ for(var i = 1; i < 13; i++) { ]]
							<option>{{i}}</option>
						[[ } ]]
					</select>
					[[ var year = (new Date).getFullYear(); ]]
					<select name='expiration_year' style='width:6em;'>
						<option>Year</option>
						[[ for(var i = year; i < year + 10; i++) { ]]
							<option>{{ i }}</option>
						[[ } ]]
					</select>
				</div>
			</div>

			<div class='control-group'>
				<label class='control-label'>Security Code</label>
				<div class='controls'>
					<input id="" type="text" name="security_code" value=""/>
				</div>
			</div>
		</div>

		<div class='echeck-selected hide'>
			<div class='control-group'>
				<label class='control-label'>Account Number</label>
				<div class='controls'>
						<input id="" type="text" name="acct_number" value=""/>
				</div>
			</div>
		</div>

		<div class="modal-form-actions" style='padding-bottom: 0'>
			<button id='new-pm-submit' class='btn'>Save</button> &nbsp;
		</div>
	</form>

	</div> <!-- end div.modal-body -->
</div> <!-- end div.modal -->


<!-- Removal modals -->

<div id='remove-pm-modal' class='modal hide'>
	<div class='modal-header'>
		<h3>Removing payment method</h3>
	</div>
	<div class='modal-body'>
		<p>Are you sure you wish to do this? Note: the payment history will remain intact</p>
		<div class='modal-form-actions'>
			<a class='btn btn-danger' href='#' id='remove-pm-submit'>Remove</a>
			&nbsp; <a href='#' data-dismiss='modal'>Cancel</a>
		</div>
	</div>
</div>

<script id='remove-charge-tmpl' type='text/template' class='hide'>
	<h4>Removing charge</h4>
	<p>Are you sure you wish to cancel this charge?</p>
	<div class='modal-form-actions'>
		<a class='btn btn-danger' href='#' id='remove-charge-submit'>Remove</a>
		<a style='float:right' href='#' class='back-to-profile btn'>Back</a>
	</div>
</script>

<script id='void-charge-tmpl' type='text/template' class='hide'>
	<h4>Void charge</h4>
	<p>Are you sure you wish to void this charge? The funds will be removed from escrow and transferred to the subscriber.</p>
	<div class='modal-form-actions'>
		<a class='btn btn-danger' href='#' id='void-charge-submit'>Void</a>
		<a style='float:right' href='#' class='back-to-profile btn'>Back</a>
	</div>
</script>

</script>
