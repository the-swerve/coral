<!doctype html>

<html>

<head>
  <title>coral payments</title>
	<link rel="stylesheet" media="screen,projection" href="css/bootstrap.css">
	<link rel="stylesheet" media="screen,projection" href="css/bootstrap-responsive.css">
	<link rel="stylesheet" media="screen,projection" href="css/style.css">
	<link rel="stylesheet" media="screen,projection" href="css/dashboard.css">
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/jquery.cookie.js"></script>
	<script type="text/javascript" src="js/underscore.js"></script>
	<script type="text/javascript" src="js/backbone.js"></script>
	<script type="text/javascript" src="js/bootstrap.js"></script>
	<script type="text/javascript" src="js/bootstrap-modal.js"></script>
	<script type="text/javascript" src="js/bootstrap-tooltip.js"></script>
	<script type="text/javascript" src="js/account.js"></script>
	<script type="text/javascript" src="js/plan.js"></script>
	<script type="text/javascript" src="js/app.js"></script>
	<script type="text/javascript" src="js/dashboard.js"></script>

	<script>
		// Load bootstrapped models served by sinatra.
		var account = new Account();
		var plans = new PlanCollection();

		$(document).ready(function() {
			var account_view = new AccountView({model: account, el: $('div#account')});
			var plan_view = new PlanView({collection: plans, el: $('div#plan')});
			account.set(<%= @account.as_hash.to_json %>);
			plans.reset(<%= @account.plans.map(&:as_hash).to_json %>);
		});
	</script>


	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
<div id="dashboard" class="container drop-shadow">


	<%= erb :nav %>

		<h2 id="account-name"><%= @account.name %></h2>
		<%= erb :'forms/settings' %>
	</div>

	<div class="tab-pane active" id="chart"> </div>

	<div id="plan">
	<%= erb :plan_template %>
	<div id="plan-header"> </div>
	<%= erb :'forms/new_plan' %>
	</div>

	<%= erb :list_profiles %>

<!-- Dialog forms -->



<div id="share-plan" class="modal hide">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal">x</button>
		<h3>Share Plan</h3>
	</div>

	<div class="modal-body">
		<p> Your plan's public page is located at <span id="plan-url-value"></span></p>
		<form id="share-plan-form">
			<label>Share with the following emails:</label>
			<textarea>Emails separated by commas</textarea>
		</form>
	</div>

	<div class="modal-footer">
		<input id="share-plan-submit" class="btn" name="commit" type="submit" value="Share" />
	</div>
</div>

<div id="edit-plan">
</div>

<div class="modal hide" id="edit-profile">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal">x</button>
		<h3>Edit Person</h3>
	</div>
	<div class="modal-body">
		<p id="edit-profile-error"></p>
		<input id="edit-profile-id" type="hidden" value="" />
		<form method="post" action="/profiles" id="edit-profile-form">
			<label>Name</label>
			<input id="edit-profile-name" type="text" name="name" /> 
			<label>Email</label>
			<input id="edit-profile-email" type="text" name="email" />
		</form>
	</div>
	<div class="modal-footer">
		<input id="edit-profile-submit" class="btn" name="commit" type="submit" value="Save" />
	</div>
</div>

<div class="hide modal" id="new-profile" title="Add Someone">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal">x</button>
		<h3>Add Someone</h3>
	</div>
	<div class="modal-body">
		<p id="new-profile-error"></p>
		<form method="post" action="/profiles" id="new-profile-form">
			<label>Name</label>
			<input type="text" name="name" />
			<label>Email</label>
			<input type="text" name="email" />
			<input type="hidden" name="plan_name" id="new-profile-plan-name" />
		</form>
	</div>
	<div class="modal-footer">
		<input id="new-profile-submit" class="btn" name="commit" type="submit" value="Save" />
	</div>
</div>

<input type="hidden" id="empty-plans" value="<%= @account.plans.empty? %>" />
<span class="hide" id="selected-plan"></span>


</div>

</body>
</html>
